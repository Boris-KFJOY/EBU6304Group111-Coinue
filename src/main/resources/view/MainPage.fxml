<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.geometry.Insets?>

<VBox xmlns="http://javafx.com/javafx"
      xmlns:fx="http://javafx.com/fxml"
      fx:controller="com.coinue.controller.MainPageController"
      spacing="10"
      prefWidth="800"
      prefHeight="600"
      style="-fx-background-color: linear-gradient(to right, #ffffff,rgb(192, 213, 255) 75%, #ffffff);">

    <!-- Top Navigation -->
    <HBox alignment="CENTER" spacing="0" style="-fx-background-color: #B0E0FF;" VBox.vgrow="NEVER">
        <Button text="Homepage" style="-fx-background-color: rgba(255,255,255,0.3); -fx-min-width: 33.33%; -fx-font-weight: bold;" onAction="#handleHomeNav" maxWidth="Infinity" HBox.hgrow="ALWAYS"/>
        <Button text="Analysis" style="-fx-background-color: transparent; -fx-min-width: 33.33%;" onAction="#handleAnalysisNav" maxWidth="Infinity" HBox.hgrow="ALWAYS"/>
        <Button text="User" style="-fx-background-color: transparent; -fx-min-width: 33.33%;" onAction="#handleUserNav" maxWidth="Infinity" HBox.hgrow="ALWAYS"/>
    </HBox>

    <!-- Main Content -->
    <VBox spacing="15.0" VBox.vgrow="ALWAYS">
        <padding>
            <Insets top="15.0" left="15.0" right="15.0" bottom="15.0"/>
        </padding>

        <!-- Top Section: Add Data Action (Horizontal Bar) -->
        <HBox spacing="20.0" alignment="CENTER" style="-fx-background-color: white; -fx-background-radius: 12px; -fx-padding: 20px; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.12), 12, 0, 0, 6);" VBox.vgrow="NEVER">
            <!-- Coinue Logo -->
            <ImageView fx:id="coinImageView" onMouseClicked="#handleCoinClick" 
                      fitHeight="60" fitWidth="60" preserveRatio="true"
                      style="-fx-cursor: hand; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 8, 0.3, 0, 3);">
                <image>
                    <Image url="@../images/Coinue.png"/>
                </image>
            </ImageView>
            
            <!-- Call-to-Action Text -->
            <VBox spacing="5" alignment="CENTER_LEFT" HBox.hgrow="ALWAYS">
                <Label text="Add Data" 
                       style="-fx-font-size: 22px; -fx-font-weight: bold; -fx-text-fill: #2196F3;"/>
                <Label text="Click the coin to record your expenses and income" 
                       style="-fx-font-size: 14px; -fx-text-fill: #666666;"/>
            </VBox>
            
            <!-- Quick Action Hint -->
            <VBox alignment="CENTER_RIGHT" spacing="5">
                <Label text="Quick Record" style="-fx-font-size: 12px; -fx-text-fill: #999999;"/>
                <Label text="üí° One Click" style="-fx-font-size: 14px;"/>
            </VBox>
        </HBox>

        <!-- Middle Section: Budget and Payment Management (Side by Side) -->
        <HBox spacing="15.0" VBox.vgrow="ALWAYS" prefHeight="280">
            
            <!-- Budget Management -->
            <VBox spacing="12.0" style="-fx-background-color: white; -fx-background-radius: 12px; -fx-padding: 18px; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 10, 0, 0, 5);" HBox.hgrow="ALWAYS">
                <HBox alignment="CENTER_LEFT" spacing="12">
                    <Label text="üí∞ Budget Management" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #333333;"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Button text="Add Budget" onAction="#handleAddBudget"
                           style="-fx-background-color: #4CAF50; -fx-text-fill: white; -fx-background-radius: 8px; -fx-padding: 8px 15px; -fx-font-size: 12px; -fx-font-weight: bold;"/>
                </HBox>
                
                <ScrollPane fitToWidth="true" VBox.vgrow="ALWAYS"
                           style="-fx-background-color: transparent; -fx-border-color: transparent;">
                    <VBox fx:id="budgetContainer" spacing="10" style="-fx-padding: 5;"/>
                </ScrollPane>
            </VBox>

            <!-- Payment Reminders -->
            <VBox spacing="12.0" style="-fx-background-color: white; -fx-background-radius: 12px; -fx-padding: 18px; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 10, 0, 0, 5);" HBox.hgrow="ALWAYS">
                <HBox alignment="CENTER_LEFT" spacing="12">
                    <Label text="‚è∞ Payment Reminders" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #333333;"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Button text="Add Reminder" onAction="#handleAddReminder"
                           style="-fx-background-color: #FF9800; -fx-text-fill: white; -fx-background-radius: 8px; -fx-padding: 8px 15px; -fx-font-size: 12px; -fx-font-weight: bold;"/>
                </HBox>
                
                <ScrollPane fitToWidth="true" VBox.vgrow="ALWAYS"
                           style="-fx-background-color: transparent; -fx-border-color: transparent;">
                    <VBox fx:id="reminderContainer" spacing="10" style="-fx-padding: 5;"/>
                </ScrollPane>
            </VBox>
        </HBox>

        <!-- Bottom Section: Recent Expense Records (Controlled Height) -->
        <VBox spacing="12.0" style="-fx-background-color: white; -fx-background-radius: 12px; -fx-padding: 18px; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 10, 0, 0, 5);" VBox.vgrow="NEVER" prefHeight="220" maxHeight="220">
            <HBox alignment="CENTER_LEFT" spacing="12">
                <Label text="üìä Recent Expense Records" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #333333;"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Label text="Latest transactions" style="-fx-font-size: 12px; -fx-text-fill: #999999;"/>
            </HBox>
            
            <TableView fx:id="expenseTableView" VBox.vgrow="ALWAYS" 
                       style="-fx-background-color: #F8F9FA; 
                              -fx-background-radius: 10px;
                              -fx-border-color: #E0E0E0;
                              -fx-border-radius: 10px;
                              -fx-border-width: 1px;">
                <columns>
                    <TableColumn fx:id="dateColumn" text="Date" prefWidth="120"
                                style="-fx-alignment: CENTER;"/>
                    <TableColumn fx:id="categoryColumn" text="Category" prefWidth="120"
                                style="-fx-alignment: CENTER;"/>
                    <TableColumn fx:id="nameColumn" text="Name" prefWidth="150"
                                style="-fx-alignment: CENTER-LEFT;"/>
                    <TableColumn fx:id="amountColumn" text="Amount" prefWidth="120"
                                style="-fx-alignment: CENTER-RIGHT;"/>
                    <TableColumn fx:id="remarksColumn" text="Remarks" prefWidth="180"
                                style="-fx-alignment: CENTER-LEFT;"/>
                    <TableColumn fx:id="deleteColumn" text="Action" prefWidth="80"
                                style="-fx-alignment: CENTER;"/>
                </columns>
                <columnResizePolicy>
                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                </columnResizePolicy>
                <style>
                    /* Ë°®Â§¥Ê†∑Âºè */
                    -fx-table-header-background: #F0F0F0;
                    -fx-table-header-border-color: #E0E0E0;
                    
                    /* ÂçïÂÖÉÊ†ºÊ†∑Âºè */
                    -fx-table-cell-border-color: #F5F5F5;
                    
                    /* ÈÄâ‰∏≠Ë°åÊ†∑Âºè */
                    -fx-selection-bar: #E3F2FD;
                    -fx-selection-bar-non-focused: #F5F5F5;
                    
                    /* Ë°®Ê†ºËÉåÊôØ */
                    -fx-background-insets: 0;
                    -fx-background-radius: 10px;
                </style>
            </TableView>
            
            <!-- GPT Chat Button -->
            <HBox alignment="CENTER_RIGHT" spacing="10">
                <Button fx:id="gptChatButton" text="üí¨ Ask GPT for Advice"
                        onAction="#handleGPTChat"
                        style="-fx-background-color: #4285f4; 
                               -fx-text-fill: white;
                               -fx-background-radius: 20;
                               -fx-padding: 8 16;
                               -fx-font-size: 14px;"/>
            </HBox>
        </VBox>
    </VBox>
</VBox>